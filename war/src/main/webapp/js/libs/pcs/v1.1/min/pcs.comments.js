define("text",["module"],function(e){"use strict";function t(e,t){return void 0===e||""===e?t:e}function n(e,n,o,r){if(n===r)return!0;if(e===o){if("http"===e)return t(n,"80")===t(r,"80");if("https"===e)return t(n,"443")===t(r,"443")}return!1}var o,r,s,i,a,c=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,m=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,u=d&&location.protocol&&location.protocol.replace(/\:/,""),p=d&&location.hostname,f=d&&(location.port||void 0),v={},h=e.config&&e.config()||{};return o={version:"2.0.15",strip:function(e){if(e){e=e.replace(l,"");var t=e.match(m);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=c[t];try{e=new ActiveXObject(n)}catch(o){}if(e){c=[n];break}}return e},parseName:function(e){var t,n,o,r=!1,s=e.lastIndexOf("."),i=0===e.indexOf("./")||0===e.indexOf("../");return-1!==s&&(!i||s>1)?(t=e.substring(0,s),n=e.substring(s+1)):t=e,o=n||t,s=o.indexOf("!"),-1!==s&&(r="strip"===o.substring(s+1),o=o.substring(0,s),n?n=o:t=o),{moduleName:t,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,r,s){var i,a,c,l=o.xdRegExp.exec(e);return l?(i=l[2],a=l[3],a=a.split(":"),c=a[1],a=a[0],(!i||i===t)&&(!a||a.toLowerCase()===r.toLowerCase())&&(!c&&!a||n(i,c,t,s))):!0},finishLoad:function(e,t,n,r){n=t?o.strip(n):n,h.isBuild&&(v[e]=n),r(n)},load:function(e,t,n,r){if(r&&r.isBuild&&!r.inlineText)return void n();h.isBuild=r&&r.isBuild;var s=o.parseName(e),i=s.moduleName+(s.ext?"."+s.ext:""),a=t.toUrl(i),c=h.useXhr||o.useXhr;return 0===a.indexOf("empty:")?void n():void(!d||c(a,u,p,f)?o.get(a,function(t){o.finishLoad(e,s.strip,t,n)},function(e){n.error&&n.error(e)}):t([i],function(e){o.finishLoad(s.moduleName+"."+s.ext,s.strip,e,n)}))},write:function(e,t,n,r){if(v.hasOwnProperty(t)){var s=o.jsEscape(v[t]);n.asModule(e+"!"+t,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,t,n,r,s){var i=o.parseName(t),a=i.ext?"."+i.ext:"",c=i.moduleName+a,l=n.toUrl(i.moduleName+a)+".js";o.load(c,n,function(t){var n=function(e){return r(l,e)};n.asModule=function(e,t){return r.asModule(e,l,t)},o.write(e,c,n,s)},s)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(r=require.nodeRequire("fs"),o.get=function(e,t,n){try{var o=r.readFileSync(e,"utf8");"\ufeff"===o[0]&&(o=o.substring(1)),t(o)}catch(s){n&&n(s)}}):"xhr"===h.env||!h.env&&o.createXhr()?o.get=function(e,t,n,r){var s,i=o.createXhr();if(i.open("GET",e,!0),r)for(s in r)r.hasOwnProperty(s)&&i.setRequestHeader(s.toLowerCase(),r[s]);h.onXhr&&h.onXhr(i,e),i.onreadystatechange=function(o){var r,s;4===i.readyState&&(r=i.status||0,r>399&&600>r?(s=new Error(e+" HTTP status: "+r),s.xhr=i,n&&n(s)):t(i.responseText),h.onXhrComplete&&h.onXhrComplete(i,e))},i.send(null)}:"rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?o.get=function(e,t){var n,o,r="utf-8",s=new java.io.File(e),i=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),r)),c="";try{for(n=new java.lang.StringBuffer,o=a.readLine(),o&&o.length()&&65279===o.charAt(0)&&(o=o.substring(1)),null!==o&&n.append(o);null!==(o=a.readLine());)n.append(i),n.append(o);c=String(n.toString())}finally{a.close()}t(c)}:("xpconnect"===h.env||!h.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(s=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in s,o.get=function(e,t){var n,o,r,c={};a&&(e=e.replace(/\//g,"\\")),r=new FileUtils.File(e);try{n=s["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(r,1,0,!1),o=s["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),c),o.close(),n.close(),t(c.value)}catch(l){throw new Error((r&&r.path||"")+": "+l)}}),o}),define("text!pcs/comments/templates/pcs-comments.html",[],function(){return'<div class="oj-row oj-panel" data-bind=\'component: {\n    name: "commentComponent",\n	params : {data : data}\n}\'></div>\n'}),function(){function e(e,t,n,o,r,s){return t[e]||(e=e.replace(/^zh-(Hans|Hant)-([^-]+)$/,"zh-$2")),t[e]?(n.push(e),!0!==t[e]&&1!==t[e]||o.push(r+e+"/"+s),!0):!1}function t(e){var t=e.toLowerCase().split(/-|_/);e=[t[0]];var n,o=1;for(n=1;n<t.length;n++){var r=t[n],s=r.length;if(1==s)break;switch(o){case 1:if(o=2,4==s){e.push(r.charAt(0).toUpperCase()+r.slice(1));break}case 2:o=3,e.push(r.toUpperCase());break;default:e.push(r)}}return"zh"!=e[0]||1<e.length&&4==e[1].length||(t="Hans",o=1<e.length?e[1]:null,("TW"===o||"MO"===o||"HK"===o)&&(t="Hant"),e.splice(1,0,t)),e}function n(e,t){for(var o in t)t.hasOwnProperty(o)&&(null==e[o]?e[o]=t[o]:"object"==typeof t[o]&&"object"==typeof e[o]&&n(e[o],t[o]))}var o=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("ojL10n",["module"],function(r){var s=r.config?r.config():{};return{version:"2.0.1+",load:function(r,i,a,c){c=c||{},c.locale&&(s.locale=c.locale);var l,m,d,u,p,f,v,h,g,y=o.exec(r),C=y[1],b=y[5],w=[],x={},j="";for(y[5]?(C=y[1],r=C+b,l=y[4]):(b=y[4],l=s.locale,"undefined"!=typeof document?(l||(l=c.isBuild?"root":document.documentElement.lang)||(l=void 0===navigator?"root":navigator.language||navigator.userLanguage||"root"),s.locale=l):l="root"),m=t(l),u=s.noOverlay,p=s.defaultNoOverlayLocale,(y=s.merge)&&(f=y[C+b])&&(y=o.exec(f),v=y[1],h=y[4]),g=[],y=0;y<m.length;y++)d=m[y],j+=(j?"-":"")+d,g.push(j);c.isBuild?(w.push(r),f&&w.push(f),i(w,function(){a()})):("query"==s.includeLocale&&(r=i.toUrl(r+".js"),r+=(-1===r.indexOf("?")?"?":"&")+"loc="+l),c=[r],f&&c.push(f),i(c,function(t,o){var r=[],s=function(t,n,o){for(var s=u||!0===t.__noOverlay,i=p||t.__defaultNoOverlayLocale,a=!1,c=g.length-1;c>=0&&(!a||!s);c--)a=e(g[c],t,r,w,n,o);c=1===g.length&&"root"===g[0],s&&(c||!a)&&i&&e(i,t,r,w,n,o),c||e("root",t,r,w,n,o)};s(t,C,b);var c=r.length;o&&s(o,v,h),i(w,function(){var e=function(e,t,o,s,a){for(;o>t&&r[t];t++){var c=r[t],l=e[c];(!0===l||1===l)&&(l=i(s+c+"/"+a)),n(x,l)}};e(o,c,r.length,v,h),e(t,0,c,C,b),x._ojLocale_=m.join("-"),a(x)})}))}}})}(),define("pcs/resources/nls/pcsSnippetsResource",{root:!0,de:!0,es:!0,fr:!0,it:!0,ja:!0,ko:!0,pt:!0,"zh-Hans":!0,"zh-Hant":!0}),define("text!pcs/comments/view/commentsContainer.html",[],function(){return'<div class="pcs-comments-detailBox">\n\n\n	<div class="pcs-comments-titleBox">\n		<h3><label class="pcs-comments-title" data-bind="text:bundle.pcs.comments.title"/></h3>\n	</div>\n\n	<div class="row pcs-comments-commontBox no-gutter" style="margin-top:20px;margin-right: 20px">\n\n		<div id="form-container" class="oj-form-layout pcs-comments-inputCommentContainer">\n			<div class="oj-form oj-sm-odd-cols-12 oj-md-odd-cols-12 oj-md-labels-inline">\n\n				<!--div class="oj-flex"-->\n					<!--div role="group" aria-labelledby="filter" class="oj-form" -->\n						<div class="oj-flex">\n							<div class="oj-flex-item" >\n								<textarea id="pcs-comments-inputComment" style="resize: both;"\n										  data-bind="ojComponent: {component: \'ojTextArea\',\n										  rootAttributes: {style:\'max-width:100%\'},\n										  validators: [{type: \'length\', options: {hint: {max: \'Enter {max} or fewer characters\'}, max: 2000}}],\n                                     value: commentStr, placeholder:bundle.pcs.comments.placeholder}" ></textarea>\n							</div>\n						<!--/div-->\n\n					<!--/div-->\n				</div>\n\n				<div class="oj-row oj-sm-text-align-end" style="display: inline-block;margin-top:5px">\n					<button id="pcs-comments-postComment" style="display: inline-block;text-align: center;"\n							data-bind="click: postComment,\n                               ojComponent: { component: \'ojButton\', label: bundle.pcs.comments.addCommentButton }">\n					</button>\n				</div>\n			</div>\n		</div>\n	</div>\n\n	<!--span id="pcs-comments-error-text" style="color:red;display:none" >Adding comment failed</span-->\n\n	<div id="pcs-comments-success-msg-container" style="display: none;margin-bottom:20px">\n		<span title="Success" role="img" class="oj-fwk-icon-status-confirmation oj-fwk-icon"></span>\n		<span id="pcs-comments-success-msg" class="pcs-comments-success-msg"></span>\n	</div>\n\n	<div id="pcs-comments-error-msg-container" class="pcs-comments-error-msg-container"  style="display: none">\n		<span class="oj-component-icon oj-message-status-icon oj-message-error-icon" role="img" id="pcs-comments-error-msg-icon" style="float: left ;margin-right:10px" ></span>\n		<pre id="pcs-comments-error-msg" class="pcs-comments-error-msg"></pre>\n	</div>\n\n	<div class="pcs-comments-actionBox">\n		<ul class="pcs-comments-commentList" data-bind="foreach:comments ">\n			<li>\n				<span style="font-weight:bold" data-bind="text: updatedBy"></span>\n				<span style="font-weight:bold" data-bind="text: updatedDateFormatted"></span>\n				<div class="pcs-comments-commentStr">\n					<div class="oj-flex" data-bind="text: commentStr"></div>\n				</div>\n				<hr/>\n			</li>\n		</ul>\n		<div id="pcs-comments-overlay"></div>\n	</div>\n</div>\n'}),define("pcs/util/loggerUtil",["jquery"],function(e){"use strict";function t(){var e=this;return e.enableLog=!1,{log:function(t){e.enableLog&&console.log(t)},error:function(t){e.enableLog&&console.error(t)},debug:function(t){e.enableLog&&console.debug(t)},warn:function(t){e.enableLog&&console.warn(t)},enableLog:function(){e.enableLog=!0},disableLog:function(){e.enableLog=!1}}}var n=new t;return n}),define("pcs/util/pcsUtil",["module","knockout","ojs/ojcore","jquery","pcs/util/loggerUtil"],function(e,t,n,o,r){"use strict";function s(){var e,t={};if(-1===window.location.href.indexOf("?"))return t;for(var n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),o=0;o<n.length;o++){e=n[o].split("=");var r=decodeURIComponent(e[0]),s=decodeURIComponent(e[1]),i=JSON.parse(s);t[r]=i}return t}var i={};o.CustomEvent=function(e){var t,n=e&&i[e];return n||(t=o.Callbacks(),n={publish:t.fire,subscribe:t.add,unsubscribe:t.remove},e&&(i[e]=n)),n},function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}return"function"==typeof window.CustomEvent?!1:(e.prototype=window.Event.prototype,void(window.CustomEvent=e))}();var a={addHandler:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},removeHandler:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}};String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,value:function(e,t){return t=t||0,this.substr(t,e.length)===e}}),String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{enumerable:!1,value:function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var o=n.indexOf(e,t);return-1!==o&&o===t}});var c=function(e){"function"==typeof window.doADFProxyCall?window.doADFProxyCall(e):e&&window.location.assign(e)},l=function(e){function t(e){for(var t=e.split("\r\n"),n="text/plain",o="pcsFormUrl",r={contentType:n,fieldName:o},s=1;s<t.length;s++){var i=t[s],a=i.match(/^.*filename="([^"]*)"/);if(a)r.fieldName=a[1];else{var c="Content-Type:";i.indexOf(c)>-1&&(a=i.substring(i.indexOf(c)+c.length)),a&&(r.contentType=a.trim())}}return r}var n=e.getResponseHeader("Content-Type"),o=e.response,r=n.match(/boundary=(?:'([^']+)'|([^;]+))/i);if(!r)throw new Error("Bad content-type header, no multipart boundary");var s,i,a=r[1]||r[2],c="string"!=typeof o;if(a="\r\n--"+a,c){var l=new Uint8Array(o),m=32768,d=[];for(i=0;i<l.length;i+=m)d.push(String.fromCharCode.apply(null,l.subarray(i,i+m)));s=d.join("")}else s=o;s="\r\n"+s;var u=s.split(new RegExp(a)),p={};for(i=1;i<u.length-1;i++){var f="\r\n\r\n",v=u[i].substring(u[i].indexOf(f)+f.length),h=u[i].substring(0,u[i].indexOf(f)),g=t(h),y=!1;c&&!g.contentType.startsWith("text")&&(y=!0),p[g.fieldName]={data:v,contentType:g.contentType,fileName:g.fieldName}}return p},m=function(e){return o.ajax({type:"GET",url:e,dataType:"text",xhrFields:{withCredentials:!0}})};return{adfProxyCall:c,getAuthToken:m,multipartParse:l,getUrlParametersObject:s,eventHandler:a,initComponentForIFrame:function(e,t,n){if(o.isEmptyObject(o.pcsConnection)){if(o.pcsConnection={},!o.isEmptyObject(e)&&(e.testMode&&(o.pcsConnection.testMode=e.testMode),e.serverURL&&(o.pcsConnection.serverURL=e.serverURL),e.authInfo))return o.pcsConnection.authInfo=e.authInfo,void t();var s=this,i=function(){var e=s.getServerURL();r.log("Script loaded and ready, getting token"),s.getAuthToken(e+"/ic/process/workspace/auth/token").done(function(e){e&&e.startsWith("<html")?n.text("User cannot be authorized").show():(o.pcsConnection.authInfo="Bearer "+e,t())}).fail(function(e){n.text("User cannot be authorized").show()})},a=document.createElement("script");a.onload=i,a.onreadystatechange=function(){"complete"===this.readyState&&i()};var c=this.getServerURL();a.src=c+"/ic/process/workspace/faces/js/homePage.js",document.getElementsByTagName("head")[0].appendChild(a)}else t()},getCookie:function(e){var t;return(t=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?t[1]:null},storeLoggedInUser:function(e){o.pcsConnection.isAdmin=e.adminFlag,o.pcsConnection.isProcessOwner=!1,e.roles&&e.roles.items&&o.each(e.roles.items,function(e,t){return t.id.endsWith(".ProcessOwner")?(o.pcsConnection.isProcessOwner=!0,!1):void 0})},getServerURL:function(){if(o.pcsConnection&&o.pcsConnection.serverURL)return o.pcsConnection.serverURL.endsWith("/")?o.pcsConnection.serverURL.substring(0,o.pcsConnection.serverURL.length-1):o.pcsConnection.serverURL;var e=window.location.origin;return o.pcsConnection||(o.pcsConnection={}),o.pcsConnection.serverURL=e,e},getRestUri:function(){return"/bpm/api/4.0/"},getAuthInfo:function(){if(o.pcsConnection&&o.pcsConnection.authInfo){var e=o.pcsConnection.authInfo;return e.startsWith("Bearer ")||e.startsWith("Basic ")||(e="Bearer "+e),e}return""},getRestURL:function(){if(o.pcsConnection&&o.pcsConnection.restURL)return o.pcsConnection.restURL;var e=this.getServerURL()+this.getRestUri();return o.pcsConnection&&(o.pcsConnection.restURL=e),e},getDpServerURL:function(){return o.pcsConnection&&o.pcsConnection.dpServerURL?o.pcsConnection.dpServerURL.endsWith("/")?o.pcsConnection.dpServerURL.substring(0,o.pcsConnection.dpServerURL.length-1):o.pcsConnection.dpServerURL:this.getServerURL()},getDpRestURL:function(){var e=this.getDpServerURL()+"/bpm/api/4.0/";return e},beforeRequestCallback:function(e,t){t.adfProxyCall();var n=t.getAuthInfo();n&&e.setRequestHeader("Authorization",n),t.isTestMode()&&e.setRequestHeader("pcs_mode","dev");var o=requirejs.s.contexts._.config.locale;o&&e.setRequestHeader("Accept-Language",o)},isTestMode:function(){return o.pcsConnection&&o.pcsConnection.testMode?!0:!1},taskIconColor:function(e){var t=["#6e8598","#754b9a","#45ac62","#ed813d","#3f92d0","#E85E93","#81BB5F","#DFE146","#FABC39","#EB5B60","#1FB4AD","#00B6D1"];if(!e)return"grey";var n,o,r,s=0;for(n=0,r=e.length;r>n;n++)o=e.charCodeAt(n),s=(s<<5)-s+o,s|=0;var i=s%t.length;return t[Math.abs(i)]},taskInitials:function(e){if(!e)return"NA";e=e.replace(" ","");for(var t=e.charAt(0).toUpperCase(),n="",o=1;o<e.length;o++)if(e.charAt(o)===e.charAt(o).toUpperCase()){n=e.charAt(o);break}return t+n},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},unApplyBindings:function(e,n){e.find("*").each(function(){o(this).off(),o(this).unbind()}),e.off(),n?(t.cleanNode(e[0]),e.find("*").each(function(){o(this).remove()}),t.removeNode(e)):(t.cleanNode(e),e.find("*").each(function(){o(this).remove()}))},compositeVersion:function(e){var t;if(e)try{var n=e.split("!"),o=n[1].split("*");t=o[0]}catch(s){r.error("Error while getting version")}return t},applicationName:function(e){var t;if(e)try{var n=e.split("~"),o=n[1].split("*");t=o[0]}catch(s){r.error("Error while getting application Name")}return t}}}),define("pcs/comments/services/commentsDataService",["jquery","pcs/util/pcsUtil"],function(e,t){"use strict";function n(){var n=this,o=require("pcs/util/loggerUtil");n.paths={taskCommentList:"tasks/{taskId}/comments",ProcessesCommentList:"processes/{processId}/comments"};var r=function(e){t.beforeRequestCallback(e,t)},s=function(t){return e.ajax({type:"GET",url:t,beforeSend:r,xhrFields:{withCredentials:!0},contentType:"application/json",dataType:"json"})},i=function(t,n,s){return o.log(n),e.ajax({type:"POST",url:t,data:n,contentType:s,dataType:"json",beforeSend:r,xhrFields:{withCredentials:!0}})};n.getCommentList=function(e,o){var r;return"task"===e?r=t.getRestURL()+n.paths.taskCommentList.replace("{taskId}",o):"process"===e&&(r=t.getRestURL()+n.paths.ProcessesCommentList.replace("{processId}",o)),s(r)},n.postComment=function(e,o,r,s){var a;return"task"===e?a=t.getRestURL()+n.paths.taskCommentList.replace("{taskId}",o):"process"===e&&(a=t.getRestURL()+n.paths.ProcessesCommentList.replace("{processId}",o)),i(a,r,s)}}return new n}),define("pcs/util/dateUtil",["knockout","ojs/ojcore","jquery","ojs/ojdatetimepicker"],function(e,t,n){"use strict";var o=function(e){if(!e)return"";var t="",n=Math.abs(e)/1e3,o=Math.floor(n/86400);n-=86400*o,t=o>0?t+o+"d ":t;var r=Math.floor(n/3600)%24;n-=3600*r,t=r>0?t+r+"h ":t;var s=Math.floor(n/60)%60;if(n-=60*s,t=s>0?t+s+"m":t,""===t){var i=Math.floor(n);t=i+"s"}return t},r=function(e){if(!e)return null;var n;if("string"==typeof e||"number"==typeof e)n=new Date(e);else{if(!(e instanceof Date))return e;n=e}var o=t.IntlConverterUtils.dateToLocalIso(n);return o},s=function(e,n){if(!e||""===e)return"";var o=n?n:"MMM dd yyyy, hh:mm a",r={pattern:o},s=t.Validation.converterFactory(t.ConverterFactory.CONVERTER_TYPE_DATETIME).createConverter(r);return s.format(e)},i=function(e){var t;if("string"==typeof e||"number"==typeof e)t=new Date(e);else{if(!(e instanceof Date))return e.toString();t=e}return t=t.toISOString()};return e.bindingHandlers.pcsFormatDate={update:function(t,n,o){var r=e.unwrap(n());if(r){var i=s(r,o().datePattern);e.bindingHandlers.text.update(t,function(){return i})}}},{getTimeDurationTxt:o,getDateInUserTimezone:r,getFormattedDate:s,getDateStingInUTCTimezone:i}}),define("pcs/comments/viewModel/commentsContainer",["ojs/ojcore","knockout","pcs/util/pcsUtil","pcs/comments/services/commentsDataService","pcs/util/dateUtil","ojs/ojknockout","ojs/ojdialog","ojs/ojbutton","ojs/ojinputtext","!text!pcs/comments/view/commentsContainer.html","ojL10n!pcs/resources/nls/pcsSnippetsResource"],function(e,t,n,o,r){"use strict";function s(e){function n(e,t){t&&""!==t&&("task"===e||"process"===e)&&($("#pcs-comments-overlay").addClass("pcs-common-load-overlay"),o.getCommentList(e,t).done(function(e){if(e.items)for(var t=e.items.length-1;t>=0;t--)s._addCommentItem(e.items[t]);$("#pcs-comments-overlay").removeClass("pcs-common-load-overlay"),s.rootElement.trigger("comments:loaded")}).fail(function(e,t,n){$("#pcs-comments-overlay").removeClass("pcs-common-load-overlay"),s.rootElement.trigger("comments:loaded")}))}var s=this;this.data=e.data;var i=require("pcs/util/loggerUtil");s.bundle=require("ojL10n!pcs/resources/nls/pcsSnippetsResource"),this.data.container=s,this.rootElement=s.data.rootElement,s.data.readOnly&&$(".pcs-comments-inputCommentContainer",s.rootElement).hide(),s.data.hideTitle&&$(".pcs-comments-titleBox",s.rootElement).hide(),s.comments=t.observableArray([]),s.commentStr=t.observable(""),("task"===s.data.mode||"process"===s.data.mode)&&n(s.data.mode,s.data.id);var a=function(e,t,n,o){this.commentStr=e,this.updatedBy=t,this.userId=n,this.updatedDate=r.getDateInUserTimezone(o),this.updatedDateFormatted=r.getFormattedDate(this.updatedDate)},c=function(e,t){this.commentStr=e,this.commentScope=t};s._addCommentItem=function(e){var t=new a(e.commentStr,e.updatedBy,e.userId,e.updateddDate);s.comments.unshift(t)},s.dispose=function(){i.log("dispose in comments Containor")},s.postComment=function(){if(0===s.commentStr().length||0===s.commentStr().trim().length)return $("#pcs-comments-error-msg",s.rootElement).text(s.bundle.pcs.comments.empty_comment),void $("#pcs-comments-error-msg-container",s.rootElement).show().delay(3e3).fadeOut(2e3);var e=new c(s.commentStr(),"BPM"),t="application/json";$("#pcs-comments-overlay").addClass("pcs-common-load-overlay"),o.postComment(s.data.mode,s.data.id,JSON.stringify(e),t).done(function(t){if(t.comment){s.comments.removeAll();for(var n=t.comment.length-1;n>=0;n--)s._addCommentItem(t.comment[n])}s.rootElement.trigger("comments:commentAdded",[e]);var o=s.bundle.pcs.comments.add_comment_success;$("#pcs-comments-success-msg",s.rootElement).text(o),$("#pcs-comments-success-msg-container",s.rootElement).show().delay(5e3).fadeOut(2e3),s.commentStr(""),$("#pcs-comments-overlay").removeClass("pcs-common-load-overlay")}).fail(function(e,t,n){var o=s.bundle.pcs.comments.post_error;e&&0===e.status&&(o=s.bundle.pcs.common.server_not_reachable),e&&500===e.status?o=s.bundle.pcs.common.internal_server_err:e&&401===e.status&&(o=s.bundle.pcs.common.access_error_msg),$("#pcs-comments-error-msg",s.rootElement).text(o),$("#pcs-comments-error-msg-container",s.rootElement).show().delay(5e3).fadeOut(2e3),$("#pcs-comments-overlay",s.rootElement).removeClass("pcs-common-load-overlay")})}}return s}),define("pcs/pcs.comments",["ojs/ojcore","knockout","jquery","!text!pcs/comments/templates/pcs-comments.html","ojL10n!pcs/resources/nls/pcsSnippetsResource","!text!pcs/comments/view/commentsContainer.html","pcs/comments/viewModel/commentsContainer","pcs/util/loggerUtil","jqueryui-amd/widget"],function(e,t,n,o,r,s,i,a){"use strict";n.widget("pcs.comments",{options:{readOnly:!1,hideTitle:!1,mode:"task",id:-1},_create:function(){function e(){var e=this;t.components.isRegistered("commentComponent")||t.components.register("commentComponent",{template:s,viewModel:i}),e.data=c}var a=this;if(void 0===n.pcsConnection)return void this.element.html("<div style='color:red'>"+r.pcs.common.pcs_connection+" </div>");var c={rootElement:a.element,readOnly:a.options.readOnly,hideTitle:a.options.hideTitle,mode:a.options.mode,id:a.options.id},l=new e;a.model=l,this.element.html(o),t.applyBindings(l,this.element[0])},destroy:function(){n.Widget.prototype.destroy.call(this)},_destroy:function(){a.log("Destroying comments"),this.model&&this.model.data&&this.model.data.container&&this.model.data.container.dispose()},_setOption:function(e,t){this.options[e]=t,n.Widget.prototype._setOption.apply(this,arguments)},getComments:function(){var e=this.model.data.container.comments();return e},getUnsavedComment:function(){var e=this.model.data.container.commentStr();return e}})});
//# sourceMappingURL=pcs.comments.js.map